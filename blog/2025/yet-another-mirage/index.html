<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Gururaj Saileshwar


  | Yet Another Mirage

</title>
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="/assets/css/github.css" />

<!-- Styles -->

<link rel="shortcut icon" href="/assets/img/favicon_book.png"/>

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/blog/2025/yet-another-mirage/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-210721562-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() { dataLayer.push(arguments); }
  gtag('js', new Date());

  gtag('config', 'UA-210721562-1');
</script>




    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>
    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="/">
       Gururaj Saileshwar
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/service/">
                service
                
              </a>
          </li>
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/students/">
                students
                
              </a>
          </li>
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <article class="post-content">
    <h2 id="yet-another-mirage-of-breaking-mirage">Yet Another Mirage of Breaking MIRAGE</h2>
<p><em>Debunking Occupancy-based Side-Channel Attacks on Fully Associative Randomized Caches</em></p>

<p><strong>Authors:</strong> Chris Cao, Gururaj Saileshwar (University of Toronto)<br />
[[Paper]https://gururaj-s.github.io/assets/pdf/Yet-Another-Mirage.pdf)] [<a href="https://github.com/sith-lab/yet-another-mirage-of-breaking-mirage">Code</a>]</p>

<hr />

<h3 id="-tldr">üìå <strong>TL;DR</strong></h3>
<p>A recent USENIX Security 2025 paper, <a href="https://www.usenix.org/conference/usenixsecurity25/presentation/chakraborty">‚ÄúSystematic Evaluation of Randomized Cache Designs against Cache Occupancy‚Äù (RCO)</a> claimed that <strong><a href="https://www.usenix.org/conference/usenixsecurity21/presentation/saileshwar">MIRAGE</a></strong> (USENIX Security 2021), a fully associative randomized cache, is vulnerable to cache-occupancy attacks that can leak AES keys. This claim has been reiterated by a subsequent <a href="https://www.usenix.org/conference/usenixsecurity25/presentation/bhatla">SoK paper</a> at USENIX Security 2025.</p>

<p>We show that these claims are <strong>incorrect</strong>. The reported leakage comes from <strong>modeling bugs</strong> in RCO, and not actual vulnerabilities. When modeled correctly, MIRAGE <strong>does not leak AES keys</strong> via occupancy attacks.  We provide more details below, and in an accompanying <a href="/assets/pdf/Yet-Another-Mirage.pdf">paper</a>.</p>

<hr />

<h3 id="update-31-aug-2025">Update (31 Aug 2025):</h3>
<p>We discover an additional bug in the RCO‚Äôs artifact in their GE analysis code (see Bug-1 below). Once we fix that, the results from RCO‚Äôs raw data now match with our naive reproduction. While the naive reproduction of RCO demonstrates low GE (key leakage), after addressing the modeling bugs in RCO (see Bug-2 below), the GE for MIRAGE remains high even with thousands of AES traces (no key leakage).</p>

<hr />

<h4 id="background"><strong>Background</strong></h4>

<p><strong>MIRAGE</strong> (<a href="https://www.usenix.org/conference/usenixsecurity21/presentation/saileshwar">USENIX Security ‚Äò21</a>) is a cache design that:</p>
<ul>
  <li>Emulates a <em>fully associative</em> cache with random replacement.</li>
  <li>Evicts cache lines <strong>globally at random</strong> to eliminate set-conflict channels.</li>
  <li>Guarantees set-associative evictions are practically impossible over a system‚Äôs lifetime.</li>
</ul>

<p><strong>Cache occupancy attacks</strong> differ from set-conflict based attacks like Prime+Probe:</p>
<ul>
  <li>They measure <em>aggregate</em> cache usage (overall occupancy).</li>
  <li>MIRAGE does <strong>not</strong> claim to eliminate such channels, but exploiting them for leaking fine-grained secrets like AES keys is challenging.</li>
</ul>

<p>The RCO paper claims MIRAGE was especially vulnerable due to its fully associative random eviction policy. We seek to evaluate these claims.</p>

<hr />

<h4 id="-finding-1-rcos-results-are-not-fully-reproducible">üîç <strong>Finding 1: RCO‚Äôs Results Are Not Fully Reproducible</strong></h4>
<p>Using RCO‚Äôs publicly released artifact, we reproduced the reported trends for AES key leakage. However, RCO reports AES key guessing entropy (GE) for MIRAGE ‚Äì higher is better ‚Äì dropping below 80 after just 300 AES traces (Mirage-RCO). In
contrast, our reproduction of their data (MIRAGE-Reproduced) shows the same GE reduction occurs after 1400 traces.</p>

<p><strong><em>Bug-1</em></strong>: We discovered that this mismatch is due to a bug in RCO‚Äôs artifact for GE calculation, in how they index traces saved across multiple files, due to which their code uses roughly 6√ó more traces than intended to calculate GE.</p>

<p><strong>Figure 1 ‚Äì Guessing Entropy Reproduction:</strong><br />
<img src="/assets/blog/yet-another-mirage/fig1_guessing_entropy.png" alt="Figure 1: Guessing Entropy Reproduction" /></p>
<blockquote>
  <p>In our reproduction of RCO‚Äôs artifact, MIRAGE‚Äôs guessing entropy drops only after 1400 AES encryptions, unlike RCO paper‚Äôs reported drop after 300 traces. Once we fix the analysis bug in RCO‚Äôs artifact, their results match our reproduction.</p>
</blockquote>

<hr />

<h4 id="-finding-2-rcos-claims-of-leakage-dont-hold">üîç <strong>Finding 2: RCO‚Äôs Claims of Leakage Don‚Äôt Hold</strong></h4>

<p>RCO attributes the leakage of the AES-Keys in the T-Table implementation in MIRAGE to:</p>
<ol>
  <li><strong>AES last-round T-Table accesses</strong> impacting cache occupancy of MIRAGE.</li>
  <li>This cache occupancy is <strong>measurable by a subsequent attacker accessing its own cached array</strong>, originally occupying 50% of the Last-level Cache, and <strong>measuring its access time</strong>.</li>
</ol>

<p>Thus, RCO claims that an attacker measuring its own access time, can perceive cache occupancy, and uncover the secret key based on its correlation with the cache occupancy.</p>

<blockquote>
  <p>However, we find that MIRAGE‚Äôs random evictions cause significant timing variations across repeated encryptions of the same plaintext and key, making keys or ciphertexts indistinguishable based on timings (see Figure-3 below).</p>
</blockquote>

<hr />

<h4 id="-finding-3-modeling-flaw-in-rco-fixed-rng-seed-for-evictions">üõë <strong>Finding 3: Modeling Flaw in RCO; Fixed RNG Seed for Evictions</strong></h4>

<p><strong><em>Bug-2:</em></strong> RCO‚Äôs simulation initializes MIRAGE‚Äôs global eviction RNG with a <strong>constant seed</strong> for every AES encryption. This produces the <strong>same deterministic sequence of evictions</strong> for every AES encryption.</p>

<p>While Cache Occupancy (<em>O</em>) is a function of both Victim Accesses (<em>V</em>) and Global Evictions (<em>GE</em>), i.e., <em>O = f(V, GE)</em> in MIRAGE, RCO‚Äôs assumption of a deterministic sequence of GEs each time artificially makes <em>O</em> trivially correlated with key-dependent memory accesses, <em>V</em>. However, this is not realistic as in a real hardware implementation, an attacker cannot reset the RNG state of the global evictions to a fixed state for each AES encryption.</p>

<p>‚úÖ <strong>Our Fix: Correct modeling of MIRAGE requires randomizing the global eviction seed</strong> per encryption (e.g., using <code class="language-plaintext highlighter-rouge">std::random_device</code> on systems where a hardware-based entropy source is available).</p>

<p>After this fix, no correlations between the victim T-Table accesses in the last round and the attacker access times are observed.</p>

<p><strong>Figure 2 ‚Äì Heatmap of Attacker Access Times vs T-Table Accesses in Last AES Round:</strong><br />
<img src="/assets/blog/yet-another-mirage/fig2_heatmaps.png" alt="Figure 2: Heatmap Correlations" /></p>

<p>This figure shows the attacker access times associated with each T-Table access performed in the last round of AES, with the 256 potential T-Table entries visualized in a 16 x 16 matrix. This heatmap is generated for both the profiled key by the attacker, and the victim key.</p>

<blockquote>
  <p>Left: Fixed seed (RCO modeling flaw) shows strong correlation ‚Üí leakage.<br />
Right: Random seed (our fix) removes correlation ‚Üí no leakage.</p>
</blockquote>

<p>The reason for the lack of correlation with random seeds is explained next.</p>

<p><strong>Figure 3 ‚Äì Attacker Access Times for Repeated Encryptions of Different Plaintexts</strong></p>

<p><img src="/assets/blog/yet-another-mirage/fig3_access_times_histogram.png" alt="Figure 3: Attacker Access Times" /></p>

<p>We show the attacker access times for four sample victim AES encryptions (repeated 100 times), with different plaintext-ciphertext pairs, selected at random. Each of these has a distinct AES T-Table access pattern.</p>

<p>With Fixed Seed (RCO) on the left, the access time is a signal that allows the encryptions to be distinguished (latency difference of ~1000 cycles).</p>

<p>With Random Seed (our fix) on the right, the access times for each of the encryptions have a considerable spread of almost 100,000 cycles. Thus, any timing variation due to minor occupancy differences is indecipherable, making the different T-Table sequences indistinguishable for an attacker.</p>

<hr />

<h4 id="-final-results-after-fixing-flaws">üèÅ Final Results After Fixing Flaws</h4>

<p><strong>Figure 4 ‚Äì Guessing Entropy After Fixes:</strong><br />
<img src="/assets/blog/yet-another-mirage/fig4_guessing_entropy_fixed.png" alt="Figure 4: Guessing Entropy After Fixes" /></p>

<blockquote>
  <p>After applying our fixes (using Random seed for RNG), we observe that the Guessing entropy for the unknown AES key in  MIRAGE remains high (above 90%), demonstrating no key leakage.</p>
</blockquote>

<p>On a side note, we observe that the RCO artifact uses a non-standard 512 <strong>byte</strong> L1 cache, in a departure from the paper, which mentions a 512 <strong>kilobyte</strong> L1 cache. Regardless, for a 512-byte or a more standard 64KB L1 cache size, MIRAGE continues to have high Guessing Entropy when modeled correctly.</p>

<hr />

<h4 id="key-takeaways">Key Takeaways</h4>

<ul>
  <li><strong>No AES Key Leakage in MIRAGE:</strong> When modeled correctly, MIRAGE is resilient to occupancy-based AES attacks.</li>
  <li><strong>Simulation Fidelity Matters:</strong> Fixed RNG seeds can introduce artificial determinism, leading to misleading conclusions.</li>
  <li><strong>Random Seed for Global Eviction Modeling:</strong> Seeding the global eviction RNG realistically captures MIRAGE‚Äôs behavior, showing that cache occupancy lacks the fine-grained visibility needed for practical attacks such as AES key extraction.</li>
</ul>

<p>For more details on these modeling flaws, please see our accompanying <a href="/assets/pdf/Yet-Another-Mirage.pdf">paper</a></p>

<hr />

<h4 id="references">References</h4>

<ol>
  <li><a href="https://www.usenix.org/conference/usenixsecurity21/presentation/saileshwar">MIRAGE: Mitigating Conflict-Based Cache Attacks with a Practical Fully-Associative Design</a>, USENIX Security 2021.</li>
  <li>RCO: <a href="https://www.usenix.org/conference/usenixsecurity25/presentation/chakraborty">Systematic Evaluation of Randomized Cache Designs against Cache Occupancy</a>, USENIX Security 2025.</li>
  <li>SoK: <a href="https://www.usenix.org/conference/usenixsecurity25/presentation/bhatla">So, You Think You Know All About Secure Randomized Caches?</a>, USENIX Security 2025.</li>
</ol>

<hr />

  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    &copy; Copyright 2025 Gururaj  Saileshwar.
    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme.

    
    
    Last updated: August 31, 2025.
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
